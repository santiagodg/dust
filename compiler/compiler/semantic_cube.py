from typing import Optional

from .dust_ast import PrimitiveType


class SemanticCube:
    def __init__(self):
        # types
        bool = PrimitiveType('bool')
        i32 = PrimitiveType('i32')
        f64 = PrimitiveType('f64')
        char = PrimitiveType('char')

        # operators
        unary_minus = 'uminus'
        unary_boolean_negation = '!'
        as_operator = 'as'
        multiplication = '*'
        division = '/'
        modulus = '%'
        sum = '+'
        subtraction = '-'
        equals = '=='
        not_equals = '!='
        greater_than = '>'
        less_than = '<'
        greater_than_or_equal = '>='
        less_than_or_equal = '<='
        and_operator = '&&'
        or_operator = '||'

        hashed_bool = hash(bool)
        hashed_i32 = hash(i32)
        hashed_f64 = hash(f64)
        hashed_char = hash(char)

        self.__cube = {}
        self.__cube[hashed_bool] = {}
        self.__cube[hashed_bool][unary_minus] = None
        self.__cube[hashed_bool][unary_boolean_negation] = bool
        self.__cube[hashed_bool][as_operator] = {}
        self.__cube[hashed_bool][as_operator][hashed_bool] = bool
        self.__cube[hashed_bool][as_operator][hashed_i32] = i32
        self.__cube[hashed_bool][as_operator][hashed_f64] = f64
        self.__cube[hashed_bool][as_operator][hashed_char] = None
        self.__cube[hashed_bool][multiplication] = {}
        self.__cube[hashed_bool][multiplication][hashed_bool] = None
        self.__cube[hashed_bool][multiplication][hashed_i32] = None
        self.__cube[hashed_bool][multiplication][hashed_f64] = None
        self.__cube[hashed_bool][multiplication][hashed_char] = None
        self.__cube[hashed_bool][division] = {}
        self.__cube[hashed_bool][division][hashed_bool] = None
        self.__cube[hashed_bool][division][hashed_i32] = None
        self.__cube[hashed_bool][division][hashed_f64] = None
        self.__cube[hashed_bool][division][hashed_char] = None
        self.__cube[hashed_bool][modulus] = {}
        self.__cube[hashed_bool][modulus][hashed_bool] = None
        self.__cube[hashed_bool][modulus][hashed_i32] = None
        self.__cube[hashed_bool][modulus][hashed_f64] = None
        self.__cube[hashed_bool][modulus][hashed_char] = None
        self.__cube[hashed_bool][sum] = {}
        self.__cube[hashed_bool][sum][hashed_bool] = None
        self.__cube[hashed_bool][sum][hashed_i32] = None
        self.__cube[hashed_bool][sum][hashed_f64] = None
        self.__cube[hashed_bool][sum][hashed_char] = None
        self.__cube[hashed_bool][subtraction] = {}
        self.__cube[hashed_bool][subtraction][hashed_bool] = None
        self.__cube[hashed_bool][subtraction][hashed_i32] = None
        self.__cube[hashed_bool][subtraction][hashed_f64] = None
        self.__cube[hashed_bool][subtraction][hashed_char] = None
        self.__cube[hashed_bool][equals] = {}
        self.__cube[hashed_bool][equals][hashed_bool] = bool
        self.__cube[hashed_bool][equals][hashed_i32] = None
        self.__cube[hashed_bool][equals][hashed_f64] = None
        self.__cube[hashed_bool][equals][hashed_char] = None
        self.__cube[hashed_bool][not_equals] = {}
        self.__cube[hashed_bool][not_equals][hashed_bool] = bool
        self.__cube[hashed_bool][not_equals][hashed_i32] = None
        self.__cube[hashed_bool][not_equals][hashed_f64] = None
        self.__cube[hashed_bool][not_equals][hashed_char] = None
        self.__cube[hashed_bool][greater_than] = {}
        self.__cube[hashed_bool][greater_than][hashed_bool] = None
        self.__cube[hashed_bool][greater_than][hashed_i32] = None
        self.__cube[hashed_bool][greater_than][hashed_f64] = None
        self.__cube[hashed_bool][greater_than][hashed_char] = None
        self.__cube[hashed_bool][less_than] = {}
        self.__cube[hashed_bool][less_than][hashed_bool] = None
        self.__cube[hashed_bool][less_than][hashed_i32] = None
        self.__cube[hashed_bool][less_than][hashed_f64] = None
        self.__cube[hashed_bool][less_than][hashed_char] = None
        self.__cube[hashed_bool][greater_than_or_equal] = {}
        self.__cube[hashed_bool][greater_than_or_equal][hashed_bool] = None
        self.__cube[hashed_bool][greater_than_or_equal][hashed_i32] = None
        self.__cube[hashed_bool][greater_than_or_equal][hashed_f64] = None
        self.__cube[hashed_bool][greater_than_or_equal][hashed_char] = None
        self.__cube[hashed_bool][less_than_or_equal] = {}
        self.__cube[hashed_bool][less_than_or_equal][hashed_bool] = None
        self.__cube[hashed_bool][less_than_or_equal][hashed_i32] = None
        self.__cube[hashed_bool][less_than_or_equal][hashed_f64] = None
        self.__cube[hashed_bool][less_than_or_equal][hashed_char] = None
        self.__cube[hashed_bool][and_operator] = {}
        self.__cube[hashed_bool][and_operator][hashed_bool] = bool
        self.__cube[hashed_bool][and_operator][hashed_i32] = None
        self.__cube[hashed_bool][and_operator][hashed_f64] = None
        self.__cube[hashed_bool][and_operator][hashed_char] = None
        self.__cube[hashed_bool][or_operator] = {}
        self.__cube[hashed_bool][or_operator][hashed_bool] = bool
        self.__cube[hashed_bool][or_operator][hashed_i32] = None
        self.__cube[hashed_bool][or_operator][hashed_f64] = None
        self.__cube[hashed_bool][or_operator][hashed_char] = None
        self.__cube[hashed_i32] = {}
        self.__cube[hashed_i32][unary_minus] = i32
        self.__cube[hashed_i32][unary_boolean_negation] = None
        self.__cube[hashed_i32][as_operator] = {}
        self.__cube[hashed_i32][as_operator][hashed_bool] = None
        self.__cube[hashed_i32][as_operator][hashed_i32] = i32
        self.__cube[hashed_i32][as_operator][hashed_f64] = f64
        self.__cube[hashed_i32][as_operator][hashed_char] = None
        self.__cube[hashed_i32][multiplication] = {}
        self.__cube[hashed_i32][multiplication][hashed_bool] = None
        self.__cube[hashed_i32][multiplication][hashed_i32] = i32
        self.__cube[hashed_i32][multiplication][hashed_f64] = None
        self.__cube[hashed_i32][multiplication][hashed_char] = None
        self.__cube[hashed_i32][division] = {}
        self.__cube[hashed_i32][division][hashed_bool] = None
        self.__cube[hashed_i32][division][hashed_i32] = i32
        self.__cube[hashed_i32][division][hashed_f64] = None
        self.__cube[hashed_i32][division][hashed_char] = None
        self.__cube[hashed_i32][modulus] = {}
        self.__cube[hashed_i32][modulus][hashed_bool] = None
        self.__cube[hashed_i32][modulus][hashed_i32] = i32
        self.__cube[hashed_i32][modulus][hashed_f64] = None
        self.__cube[hashed_i32][modulus][hashed_char] = None
        self.__cube[hashed_i32][sum] = {}
        self.__cube[hashed_i32][sum][hashed_bool] = None
        self.__cube[hashed_i32][sum][hashed_i32] = i32
        self.__cube[hashed_i32][sum][hashed_f64] = None
        self.__cube[hashed_i32][sum][hashed_char] = None
        self.__cube[hashed_i32][subtraction] = {}
        self.__cube[hashed_i32][subtraction][hashed_bool] = None
        self.__cube[hashed_i32][subtraction][hashed_i32] = i32
        self.__cube[hashed_i32][subtraction][hashed_f64] = None
        self.__cube[hashed_i32][subtraction][hashed_char] = None
        self.__cube[hashed_i32][equals] = {}
        self.__cube[hashed_i32][equals][hashed_bool] = None
        self.__cube[hashed_i32][equals][hashed_i32] = bool
        self.__cube[hashed_i32][equals][hashed_f64] = None
        self.__cube[hashed_i32][equals][hashed_char] = None
        self.__cube[hashed_i32][not_equals] = {}
        self.__cube[hashed_i32][not_equals][hashed_bool] = None
        self.__cube[hashed_i32][not_equals][hashed_i32] = bool
        self.__cube[hashed_i32][not_equals][hashed_f64] = None
        self.__cube[hashed_i32][not_equals][hashed_char] = None
        self.__cube[hashed_i32][greater_than] = {}
        self.__cube[hashed_i32][greater_than][hashed_bool] = None
        self.__cube[hashed_i32][greater_than][hashed_i32] = bool
        self.__cube[hashed_i32][greater_than][hashed_f64] = None
        self.__cube[hashed_i32][greater_than][hashed_char] = None
        self.__cube[hashed_i32][less_than] = {}
        self.__cube[hashed_i32][less_than][hashed_bool] = None
        self.__cube[hashed_i32][less_than][hashed_i32] = bool
        self.__cube[hashed_i32][less_than][hashed_f64] = None
        self.__cube[hashed_i32][less_than][hashed_char] = None
        self.__cube[hashed_i32][greater_than_or_equal] = {}
        self.__cube[hashed_i32][greater_than_or_equal][hashed_bool] = None
        self.__cube[hashed_i32][greater_than_or_equal][hashed_i32] = bool
        self.__cube[hashed_i32][greater_than_or_equal][hashed_f64] = None
        self.__cube[hashed_i32][greater_than_or_equal][hashed_char] = None
        self.__cube[hashed_i32][less_than_or_equal] = {}
        self.__cube[hashed_i32][less_than_or_equal][hashed_bool] = None
        self.__cube[hashed_i32][less_than_or_equal][hashed_i32] = bool
        self.__cube[hashed_i32][less_than_or_equal][hashed_f64] = None
        self.__cube[hashed_i32][less_than_or_equal][hashed_char] = None
        self.__cube[hashed_i32][and_operator] = {}
        self.__cube[hashed_i32][and_operator][hashed_bool] = None
        self.__cube[hashed_i32][and_operator][hashed_i32] = None
        self.__cube[hashed_i32][and_operator][hashed_f64] = None
        self.__cube[hashed_i32][and_operator][hashed_char] = None
        self.__cube[hashed_i32][or_operator] = {}
        self.__cube[hashed_i32][or_operator][hashed_bool] = None
        self.__cube[hashed_i32][or_operator][hashed_i32] = None
        self.__cube[hashed_i32][or_operator][hashed_f64] = None
        self.__cube[hashed_i32][or_operator][hashed_char] = None
        self.__cube[hashed_f64] = {}
        self.__cube[hashed_f64][unary_minus] = f64
        self.__cube[hashed_f64][unary_boolean_negation] = None
        self.__cube[hashed_f64][as_operator] = {}
        self.__cube[hashed_f64][as_operator][hashed_bool] = None
        self.__cube[hashed_f64][as_operator][hashed_i32] = i32
        self.__cube[hashed_f64][as_operator][hashed_f64] = f64
        self.__cube[hashed_f64][as_operator][hashed_char] = None
        self.__cube[hashed_f64][multiplication] = {}
        self.__cube[hashed_f64][multiplication][hashed_bool] = None
        self.__cube[hashed_f64][multiplication][hashed_i32] = None
        self.__cube[hashed_f64][multiplication][hashed_f64] = f64
        self.__cube[hashed_f64][multiplication][hashed_char] = None
        self.__cube[hashed_f64][division] = {}
        self.__cube[hashed_f64][division][hashed_bool] = None
        self.__cube[hashed_f64][division][hashed_i32] = None
        self.__cube[hashed_f64][division][hashed_f64] = f64
        self.__cube[hashed_f64][division][hashed_char] = None
        self.__cube[hashed_f64][modulus] = {}
        self.__cube[hashed_f64][modulus][hashed_bool] = None
        self.__cube[hashed_f64][modulus][hashed_i32] = None
        self.__cube[hashed_f64][modulus][hashed_f64] = None
        self.__cube[hashed_f64][modulus][hashed_char] = None
        self.__cube[hashed_f64][sum] = {}
        self.__cube[hashed_f64][sum][hashed_bool] = None
        self.__cube[hashed_f64][sum][hashed_i32] = None
        self.__cube[hashed_f64][sum][hashed_f64] = f64
        self.__cube[hashed_f64][sum][hashed_char] = None
        self.__cube[hashed_f64][subtraction] = {}
        self.__cube[hashed_f64][subtraction][hashed_bool] = None
        self.__cube[hashed_f64][subtraction][hashed_i32] = None
        self.__cube[hashed_f64][subtraction][hashed_f64] = f64
        self.__cube[hashed_f64][subtraction][hashed_char] = None
        self.__cube[hashed_f64][equals] = {}
        self.__cube[hashed_f64][equals][hashed_bool] = None
        self.__cube[hashed_f64][equals][hashed_i32] = None
        self.__cube[hashed_f64][equals][hashed_f64] = bool
        self.__cube[hashed_f64][equals][hashed_char] = None
        self.__cube[hashed_f64][not_equals] = {}
        self.__cube[hashed_f64][not_equals][hashed_bool] = None
        self.__cube[hashed_f64][not_equals][hashed_i32] = None
        self.__cube[hashed_f64][not_equals][hashed_f64] = bool
        self.__cube[hashed_f64][not_equals][hashed_char] = None
        self.__cube[hashed_f64][greater_than] = {}
        self.__cube[hashed_f64][greater_than][hashed_bool] = None
        self.__cube[hashed_f64][greater_than][hashed_i32] = None
        self.__cube[hashed_f64][greater_than][hashed_f64] = bool
        self.__cube[hashed_f64][greater_than][hashed_char] = None
        self.__cube[hashed_f64][less_than] = {}
        self.__cube[hashed_f64][less_than][hashed_bool] = None
        self.__cube[hashed_f64][less_than][hashed_i32] = None
        self.__cube[hashed_f64][less_than][hashed_f64] = bool
        self.__cube[hashed_f64][less_than][hashed_char] = None
        self.__cube[hashed_f64][greater_than_or_equal] = {}
        self.__cube[hashed_f64][greater_than_or_equal][hashed_bool] = None
        self.__cube[hashed_f64][greater_than_or_equal][hashed_i32] = None
        self.__cube[hashed_f64][greater_than_or_equal][hashed_f64] = bool
        self.__cube[hashed_f64][greater_than_or_equal][hashed_char] = None
        self.__cube[hashed_f64][less_than_or_equal] = {}
        self.__cube[hashed_f64][less_than_or_equal][hashed_bool] = None
        self.__cube[hashed_f64][less_than_or_equal][hashed_i32] = None
        self.__cube[hashed_f64][less_than_or_equal][hashed_f64] = bool
        self.__cube[hashed_f64][less_than_or_equal][hashed_char] = None
        self.__cube[hashed_f64][and_operator] = {}
        self.__cube[hashed_f64][and_operator][hashed_bool] = None
        self.__cube[hashed_f64][and_operator][hashed_i32] = None
        self.__cube[hashed_f64][and_operator][hashed_f64] = None
        self.__cube[hashed_f64][and_operator][hashed_char] = None
        self.__cube[hashed_f64][or_operator] = {}
        self.__cube[hashed_f64][or_operator][hashed_bool] = None
        self.__cube[hashed_f64][or_operator][hashed_i32] = None
        self.__cube[hashed_f64][or_operator][hashed_f64] = None
        self.__cube[hashed_f64][or_operator][hashed_char] = None
        self.__cube[hashed_char] = {}
        self.__cube[hashed_char][unary_minus] = None
        self.__cube[hashed_char][unary_boolean_negation] = None
        self.__cube[hashed_char][as_operator] = {}
        self.__cube[hashed_char][as_operator][hashed_bool] = None
        self.__cube[hashed_char][as_operator][hashed_i32] = i32
        self.__cube[hashed_char][as_operator][hashed_f64] = None
        self.__cube[hashed_char][as_operator][hashed_char] = char
        self.__cube[hashed_char][multiplication] = {}
        self.__cube[hashed_char][multiplication][hashed_bool] = None
        self.__cube[hashed_char][multiplication][hashed_i32] = None
        self.__cube[hashed_char][multiplication][hashed_f64] = None
        self.__cube[hashed_char][multiplication][hashed_char] = None
        self.__cube[hashed_char][division] = {}
        self.__cube[hashed_char][division][hashed_bool] = None
        self.__cube[hashed_char][division][hashed_i32] = None
        self.__cube[hashed_char][division][hashed_f64] = None
        self.__cube[hashed_char][division][hashed_char] = None
        self.__cube[hashed_char][modulus] = {}
        self.__cube[hashed_char][modulus][hashed_bool] = None
        self.__cube[hashed_char][modulus][hashed_i32] = None
        self.__cube[hashed_char][modulus][hashed_f64] = None
        self.__cube[hashed_char][modulus][hashed_char] = None
        self.__cube[hashed_char][sum] = {}
        self.__cube[hashed_char][sum][hashed_bool] = None
        self.__cube[hashed_char][sum][hashed_i32] = None
        self.__cube[hashed_char][sum][hashed_f64] = None
        self.__cube[hashed_char][sum][hashed_char] = None
        self.__cube[hashed_char][subtraction] = {}
        self.__cube[hashed_char][subtraction][hashed_bool] = None
        self.__cube[hashed_char][subtraction][hashed_i32] = None
        self.__cube[hashed_char][subtraction][hashed_f64] = None
        self.__cube[hashed_char][subtraction][hashed_char] = None
        self.__cube[hashed_char][equals] = {}
        self.__cube[hashed_char][equals][hashed_bool] = None
        self.__cube[hashed_char][equals][hashed_i32] = None
        self.__cube[hashed_char][equals][hashed_f64] = None
        self.__cube[hashed_char][equals][hashed_char] = bool
        self.__cube[hashed_char][not_equals] = {}
        self.__cube[hashed_char][not_equals][hashed_bool] = None
        self.__cube[hashed_char][not_equals][hashed_i32] = None
        self.__cube[hashed_char][not_equals][hashed_f64] = None
        self.__cube[hashed_char][not_equals][hashed_char] = bool
        self.__cube[hashed_char][greater_than] = {}
        self.__cube[hashed_char][greater_than][hashed_bool] = None
        self.__cube[hashed_char][greater_than][hashed_i32] = None
        self.__cube[hashed_char][greater_than][hashed_f64] = None
        self.__cube[hashed_char][greater_than][hashed_char] = bool
        self.__cube[hashed_char][less_than] = {}
        self.__cube[hashed_char][less_than][hashed_bool] = None
        self.__cube[hashed_char][less_than][hashed_i32] = None
        self.__cube[hashed_char][less_than][hashed_f64] = None
        self.__cube[hashed_char][less_than][hashed_char] = bool
        self.__cube[hashed_char][greater_than_or_equal] = {}
        self.__cube[hashed_char][greater_than_or_equal][hashed_bool] = None
        self.__cube[hashed_char][greater_than_or_equal][hashed_i32] = None
        self.__cube[hashed_char][greater_than_or_equal][hashed_f64] = None
        self.__cube[hashed_char][greater_than_or_equal][hashed_char] = bool
        self.__cube[hashed_char][less_than_or_equal] = {}
        self.__cube[hashed_char][less_than_or_equal][hashed_bool] = None
        self.__cube[hashed_char][less_than_or_equal][hashed_i32] = None
        self.__cube[hashed_char][less_than_or_equal][hashed_f64] = None
        self.__cube[hashed_char][less_than_or_equal][hashed_char] = bool
        self.__cube[hashed_char][and_operator] = {}
        self.__cube[hashed_char][and_operator][hashed_bool] = None
        self.__cube[hashed_char][and_operator][hashed_i32] = None
        self.__cube[hashed_char][and_operator][hashed_f64] = None
        self.__cube[hashed_char][and_operator][hashed_char] = None
        self.__cube[hashed_char][or_operator] = {}
        self.__cube[hashed_char][or_operator][hashed_bool] = None
        self.__cube[hashed_char][or_operator][hashed_i32] = None
        self.__cube[hashed_char][or_operator][hashed_f64] = None
        self.__cube[hashed_char][or_operator][hashed_char] = None

    def search_binary_operation(self,
                                left_type: PrimitiveType,
                                operator: str,
                                right_type: PrimitiveType
                                ) -> Optional[PrimitiveType]:
        return self.__cube[hash(left_type)][operator][hash(right_type)]

    def search_unary_operation(self, operator: str, type: PrimitiveType) -> Optional[PrimitiveType]:
        return self.__cube[hash(type)][operator]
